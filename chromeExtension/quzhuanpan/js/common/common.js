!function(){let e={html404Title:"页面不存在",htmlNonExistent:"链接不存在",htmlNeedPassword:"请输入提取码",htmlNormal:"分享无限制"};var t={};let n={};saveKey=[];var s={analysisBaiduPanUrl:function(){findAndReplaceDOMText(document.body,{find:/(?:https?:\/\/)?pan\.baidu\.com\/s\/([\w\-]{4,25})\b/g,replace:function(e,t){let s,l,a=e.node,o=t[0],i=!1;for(;a=a.parentNode;){if("QUZHUANPAN-PLUGIN"===a.nodeName){s=a;break}if("BODY"===a.nodeName||"HTML"===a.nodeName)break;!i&&"A"===a.nodeName&&a.href&&(i=!0)}if(s)l=e.text;else{if(s=document.createElement("QUZHUANPAN-PLUGIN"),0==e.index){let t=document.createElement("QUZHUANPAN-PLUGIN-TIPS");t.setAttribute("title",""),s.appendChild(t);let n=document.createTextNode(e.text);s.appendChild(n)}else s.textContent=e.text;i||(s.onclick=function(e){e.stopPropagation(),e.preventDefault(),-1==o.indexOf("https")&&(o=o.replace("http","https")),-1==o.indexOf("https://")&&(o="https://"+url),window.open(o,"_blank")}),l=s}let d=t[1];return n[d]?n[d].elements.push(s):n[d]={elements:[s],pwd:""},saveKey.push(d),l},preset:"prose"})},judge:function(t,n){console.log("111");let s={judgeResult:""};var l=new XMLHttpRequest;-1==t.indexOf("https")&&(t=t.replace("http","https")),-1==t.indexOf("https://")&&(t="https://"+t),t=t.replace(/\s/g,""),l.open("GET",t,!0),l.send(null),l.onreadystatechange=function(){if(4==l.readyState){if(200==l.status){console.log(2);let t=l.responseText;t?((t=t.replace(/\s+/g,"")).length>5e3&&(t=t.substring(0,4999)),console.log(t),-1!=t.indexOf(e.htmlNonExistent)?s.judgeResult="isNonExistent":-1!=t.indexOf(e.htmlNeedPassword)?s.judgeResult="isNeedPassword":-1!=t.indexOf(e.htmlNormal)?s.judgeResult="isOk":-1!=t.indexOf(e.html404Title)&&(s.judgeResult="isUncertainty")):s.judgeResult="isUncertainty"}else 404==l.status&&(console.log(3),s.judgeResult="isUncertainty");let t;for(let e=0;e<n.length;e++)t=n[e],"isOk"==s.judgeResult?t.classList.add("QUZHUANPAN-PLUGIN-VALIDATE-PASS"):"isNonExistent"==s.judgeResult?t.classList.add("QUZHUANPAN-PLUGIN-VALIDATE-NOTPASS"):"isNeedPassword"==s.judgeResult?t.classList.add("QUZHUANPAN-PLUGIN-VALIDATE-LOCK"):"isUncertainty"==s.judgeResult&&t.classList.add("QUZHUANPAN-PLUGIN-VALIDATE-UNCERTAINTY")}}},sleep:function(e){for(var t=new Date,n=t.getTime()+e;;)if((t=new Date).getTime()>n)return},createRandom:function(e,t){return Math.floor(Math.random()*(t-e)+e)},collectAndDealUrl:function(){let e=new Array,t=!1;for(let n=0;n<saveKey.length;n++){t=!1;for(let s=0;s<e.length;s++)if(saveKey[n]==e[s]){t=!0;break}t||e.push(saveKey[n])}for(let t=0;t<e.length;t++){let l=n[e[t]].elements,a="";for(let e=0;e<l.length&&-1==(a+=l[e].innerText).indexOf("pan.baidu.com/s/");e++);a&&s.judge(a,l)}}};chrome.runtime.sendMessage({origin:"common-pan-status"},function(n){var l=n.pageTitleTextsObj;e.html404Title=l.html404Title,e.htmlNonExistent=l.htmlNonExistent,e.htmlNeedPassword=l.htmlNeedPassword,e.htmlNormal=l.htmlNormal,1!=(t=n.settingObj).judgePanStatus&&"1"!=t.judgePanStatus||(s.analysisBaiduPanUrl(),s.collectAndDealUrl()),console.log(e)})}();