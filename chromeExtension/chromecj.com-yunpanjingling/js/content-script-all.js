!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=76)}({76:function(e,t,n){let r=n(77);$(document).ready(function(){let e={},t=function(e){switch(e){case"14px":case"16px":return 14;case"18px":return 16;case"20px":return 18;case"22px":return 20;case"24px":return 22}return 14},n=function(e){switch(e){case"14px":case"16px":return 2;case"18px":case"20px":case"22px":case"24px":return 4}return 2};$("body > div:contains('pan.baidu.com')").each(function(){$(this).find("a").each(function(){let e=$(this).html();-1===e.indexOf("<script")&&$(this).html(e.replace(/pan\.baidu\.com/gi,"####BDY####"))}),$(this).find("textarea").each(function(){let e=$(this).html();$(this).html(e.replace(/pan\.baidu\.com/gi,"####BDY####"))}),r($(this)[0],{find:/([ ])(s\/1[a-zA-Z0-9_\-]{5,22})/g,replace:function(e,t){return document.createTextNode(t[1]+"/"+t[2])}}),r($(this)[0],{find:/([ ])(\/s\/1[a-zA-Z0-9_\-]{5,22})/g,replace:function(e,t){return document.createTextNode(t[1]+"pan.baidu.com"+t[2])}}),r($(this)[0],{find:/https?:\/\/pan\.baidu\.com\/s\/1[a-zA-Z0-9_\-]{5,22}/gi,replace:function(e,t){let n=document.createElement("a"),r=document.createTextNode(t.toString().replace(/pan\.baidu\.com/gi,"####BDY####"));return n.href=t,n.target="_blank",n.appendChild(r),n}}),r($(this)[0],{find:/pan\.baidu\.com\/s\/1[a-zA-Z0-9_\-]{5,22}/gi,replace:function(e,t){let n=document.createElement("a"),r=document.createTextNode("https://"+t);return n.href="https://"+t,n.target="_blank",n.appendChild(r),n}}),$(this).find("textarea").each(function(){let e=$(this).html();$(this).html(e.replace(/####BDY####/g,"pan.baidu.com"))}),$(this).find("a").each(function(){let e=$(this).html();-1===e.indexOf("<script")&&$(this).html(e.replace(/####BDY####/g,"pan.baidu.com"))})}),function(){if($("a").each(function(){let t=$(this).attr("href"),n=$(this).text(),r=BaseLib.fetchUuid(t);null!==r?e[r]=null:null!==(r=BaseLib.fetchUuid(n))&&(e[r]=null)}),Object.keys(e).length>0){let r={cmd:"CHECK_DATA",uncheckedUuids:e};chrome.runtime.sendMessage(r,function(e){console.log("收到："+JSON.stringify(e)),$("a").each(function(){let r=$(this).attr("href"),i=$(this).text(),a=BaseLib.fetchUuid(r);null===a&&(a=BaseLib.fetchUuid(i)),null!==a&&void 0!==e[a]&&null!==e[a]&&(void 0===e[a].state||"VALID"===e[a].state?void 0!==e[a].access_code?function(e){let r=t($(e).css("font-size")),i=n($(e).css("font-size"));$('<img src="data:image/png;base64,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" style="display:inline-block;width:'+r+"px;margin:0 5px "+i+'px 0;vertical-align:middle;" title="YPSuperKey Unlocked">').prependTo($(e))}(this):"VALID"===e[a].state&&function(e){let r=t($(e).css("font-size")),i=n($(e).css("font-size"));$('<img src="data:image/png;base64,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" style="display:inline-block;width:'+r+"px;margin:0 5px "+i+'px 0;vertical-align:middle;" title="YPSuperKey Checked">').prependTo($(e))}(this):"INVALID"===e[a].state&&function(e){let r=t($(e).css("font-size")),i=n($(e).css("font-size"));$('<img src="data:image/png;base64,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" style="display:inline-block;width:'+r+"px;margin:0 5px "+i+'px 0;vertical-align:middle;" title="YPSuperKey Broken">').prependTo($(e)),$(e).css("text-decoration","line-through").css("color","#ccc"),$(e).attr("title","该资源已失效")}(this))})})}}()})},77:function(e,t,n){var r,i;
/**
 * findAndReplaceDOMText v 0.4.6
 * @author James Padolsey http://james.padolsey.com
 * @license http://unlicense.org/UNLICENSE
 *
 * Matches the text of a DOM node against a regular expression
 * and replaces each match (or node-separated portions of the match)
 * in the specified element.
 */
/**
 * findAndReplaceDOMText v 0.4.6
 * @author James Padolsey http://james.padolsey.com
 * @license http://unlicense.org/UNLICENSE
 *
 * Matches the text of a DOM node against a regular expression
 * and replaces each match (or node-separated portions of the match)
 * in the specified element.
 */
!function(a,o){"object"==typeof e&&e.exports?e.exports=o():void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i)}(0,function(){var e="retain",t=document,n={}.hasOwnProperty;function r(){return function(e,t,n,a,o){if(t&&!t.nodeType&&arguments.length<=2)return!1;var d="function"==typeof n;d&&(n=function(e){return function(t,n){return e(t.text,n.startIndex)}}(n));var s=i(t,{find:e,wrap:d?null:n,replace:d?n:"$"+(a||"&"),prepMatch:function(e,t){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(a>0){var n=e[a];e.index+=e[0].indexOf(n),e[0]=n}return e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=t,e},filterElements:o});return r.revert=function(){return s.revert()},!0}.apply(null,arguments)||i.apply(null,arguments)}function i(e,t){return new a(e,t)}function a(t,i){var a=i.preset&&r.PRESETS[i.preset];if(i.portionMode=i.portionMode||e,a)for(var o in a)n.call(a,o)&&!n.call(i,o)&&(i[o]=a[o]);this.node=t,this.options=i,this.prepMatch=i.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return r.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},r.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},r.NON_INLINE_PROSE=function(e){return n.call(r.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},r.PRESETS={prose:{forceContext:r.NON_INLINE_PROSE,filterElements:function(e){return!n.call(r.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},r.Finder=a,a.prototype={search:function(){var e,t=0,n=0,r=this.options.find,i=this.getAggregateText(),a=[],o=this;return r="string"==typeof r?RegExp(function(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}(r),"g"):r,function i(d){for(var s=0,c=d.length;s<c;++s){var l=d[s];if("string"==typeof l){if(r.global)for(;e=r.exec(l);)a.push(o.prepMatch(e,t++,n));else(e=l.match(r))&&a.push(o.prepMatch(e,0,n));n+=l.length}else i(l)}}(i),a},prepMatch:function(e,t,n){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=n+e.index+e[0].length,e.startIndex=n+e.index,e.index=t,e},getAggregateText:function(){var e=this.options.filterElements,t=this.options.forceContext;return function n(r){if(r.nodeType===Node.TEXT_NODE)return[r.data];if(e&&!e(r))return[];var i=[""];var a=0;if(r=r.firstChild)do{if(r.nodeType!==Node.TEXT_NODE){var o=n(r);t&&r.nodeType===Node.ELEMENT_NODE&&(!0===t||t(r))?(i[++a]=o,i[++a]=""):("string"==typeof o[0]&&(i[a]+=o.shift()),o.length&&(i[++a]=o,i[++a]=""))}else i[a]+=r.data}while(r=r.nextSibling);return i}(this.node)},processMatches:function(){var e,t,n,r=this.matches,i=this.node,a=this.options.filterElements,o=[],d=i,s=r.shift(),c=0,l=0,p=[i];e:for(;;){if(d.nodeType===Node.TEXT_NODE&&(!t&&d.length+c>=s.endIndex?t={node:d,index:l++,text:d.data.substring(s.startIndex-c,s.endIndex-c),indexInMatch:0===c?0:c-s.startIndex,indexInNode:s.startIndex-c,endIndexInNode:s.endIndex-c,isEnd:!0}:e&&o.push({node:d,index:l++,text:d.data,indexInMatch:c-s.startIndex,indexInNode:0}),!e&&d.length+c>s.startIndex&&(e={node:d,index:l++,indexInMatch:0,indexInNode:s.startIndex-c,endIndexInNode:s.endIndex-c,text:d.data.substring(s.startIndex-c,s.endIndex-c)}),c+=d.data.length),n=d.nodeType===Node.ELEMENT_NODE&&a&&!a(d),e&&t){if(d=this.replaceMatch(s,e,o,t),c-=t.node.data.length-t.endIndexInNode,e=null,t=null,o=[],l=0,0,!(s=r.shift()))break}else if(!n&&(d.firstChild||d.nextSibling)){d.firstChild?(p.push(d),d=d.firstChild):d=d.nextSibling;continue}for(;;){if(d.nextSibling){d=d.nextSibling;break}if((d=p.pop())===i)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,t,n){var r=this.options.portionMode;return"first"===r&&t.indexInMatch>0?"":(e=e.replace(/\$(\d+|&|`|')/g,function(e,t){var r;switch(t){case"&":r=n[0];break;case"`":r=n.input.substring(0,n.startIndex);break;case"'":r=n.input.substring(n.endIndex);break;default:r=n[+t]||""}return r}),"first"===r?e:t.isEnd?e.substring(t.indexInMatch):e.substring(t.indexInMatch,t.indexInMatch+t.text.length))},getPortionReplacementNode:function(e,n){var r=this.options.replace||"$&",i=this.options.wrap,a=this.options.wrapClass;if(i&&i.nodeType){var o=t.createElement("div");o.innerHTML=i.outerHTML||(new XMLSerializer).serializeToString(i),i=o.firstChild}if("function"==typeof r)return(r=r(e,n))&&r.nodeType?r:t.createTextNode(String(r));var d="string"==typeof i?t.createElement(i):i;return d&&a&&(d.className=a),(r=t.createTextNode(this.prepareReplacementString(r,e,n))).data&&d?(d.appendChild(r),d):r},replaceMatch:function(e,n,r,i){var a,o,d=n.node,s=i.node;if(d===s){var c=d;n.indexInNode>0&&(a=t.createTextNode(c.data.substring(0,n.indexInNode)),c.parentNode.insertBefore(a,c));var l=this.getPortionReplacementNode(i,e);return c.parentNode.insertBefore(l,c),i.endIndexInNode<c.length&&(o=t.createTextNode(c.data.substring(i.endIndexInNode)),c.parentNode.insertBefore(o,c)),c.parentNode.removeChild(c),this.reverts.push(function(){a===l.previousSibling&&a.parentNode.removeChild(a),o===l.nextSibling&&o.parentNode.removeChild(o),l.parentNode.replaceChild(c,l)}),l}a=t.createTextNode(d.data.substring(0,n.indexInNode)),o=t.createTextNode(s.data.substring(i.endIndexInNode));for(var p=this.getPortionReplacementNode(n,e),A=[],u=0,h=r.length;u<h;++u){var f=r[u],g=this.getPortionReplacementNode(f,e);f.node.parentNode.replaceChild(g,f.node),this.reverts.push(function(e,t){return function(){t.parentNode.replaceChild(e.node,t)}}(f,g)),A.push(g)}var x=this.getPortionReplacementNode(i,e);return d.parentNode.insertBefore(a,d),d.parentNode.insertBefore(p,d),d.parentNode.removeChild(d),s.parentNode.insertBefore(x,s),s.parentNode.insertBefore(o,s),s.parentNode.removeChild(s),this.reverts.push(function(){a.parentNode.removeChild(a),p.parentNode.replaceChild(d,p),o.parentNode.removeChild(o),x.parentNode.replaceChild(s,x)}),x}},r})}});