!function(e){var n={};function o(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=n,o.d=function(e,n,r){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)o.d(r,t,function(n){return e[n]}.bind(null,t));return r},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=75)}({75:function(e,n,o){"use strict";window.BackgroundLib={webServer:"https://ypsuperkey.meek.com.cn",apiServer:"https://ypsuperkey.meek.com.cn/api",manifest:chrome.runtime.getManifest()},BackgroundLib.fetchSelector=function(){let e="client_version="+encodeURIComponent(BackgroundLib.manifest.version),n=BackgroundLib.apiServer+"/v1/extension/selector?"+e,o=new XMLHttpRequest;return o.open("GET",n,!1),o.send(null),200===o.status?JSON.parse(o.responseText):null},BackgroundLib.fetchAccessCode=function(e){let n="client_version="+encodeURIComponent(BackgroundLib.manifest.version),o=BackgroundLib.apiServer+"/v1/items/"+e+"?"+n,r=new XMLHttpRequest;r.open("GET",o,!1),r.send(null);let t=JSON.parse(r.responseText);return 200===r.status?t.access_code:404===r.status?null:415===r.status?"*_*HTTP-415*_*":500===r.status?"*_*HTTP-500*_*":503===r.status?"*_*HTTP-503*_*":"*_*ERROR*_*"},BackgroundLib.sendAccessCode=function(e,n){let o="access_code="+encodeURIComponent(n)+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=BackgroundLib.apiServer+"/v1/items/"+e,t=new XMLHttpRequest;t.open("POST",r,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(o);let s=JSON.parse(t.responseText);console.log("数据已发送至服务器。"+t.status+" // "+JSON.stringify(s))},BackgroundLib.sendState=function(e,n){let o="state="+encodeURIComponent(n)+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=BackgroundLib.apiServer+"/v1/items/"+e,t=new XMLHttpRequest;t.open("POST",r,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(o);let s=JSON.parse(t.responseText);console.log("数据已发送至服务器。"+t.status+" // "+JSON.stringify(s))},BackgroundLib.sendReferrer=function(e,n){let o="referrer[url]="+encodeURIComponent(n.url)+"&referrer[title]="+encodeURIComponent(n.title)+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=BackgroundLib.apiServer+"/v1/items/"+e,t=new XMLHttpRequest;t.open("POST",r,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(o);let s=JSON.parse(t.responseText);console.log("数据已发送至服务器。"+t.status+" // "+JSON.stringify(s))},BackgroundLib.sendResource=function(e,n){let o="resource[mode]="+encodeURIComponent(n.mode)+"&resource[share_time]="+encodeURIComponent(n.share_time)+"&resource[name]="+encodeURIComponent(n.name)+"&resource[size]="+encodeURIComponent(n.size)+"&resource[user_id]="+encodeURIComponent(n.user_id)+"&resource[user_name]="+encodeURIComponent(n.user_name)+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=BackgroundLib.apiServer+"/v1/resources/"+e,t=new XMLHttpRequest;t.open("POST",r,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(o);let s=JSON.parse(t.responseText);console.log("数据已发送至服务器。"+t.status+" // "+JSON.stringify(s))},BackgroundLib.sendSubnodes=function(e,n){let o="subnodes="+encodeURIComponent(n)+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=BackgroundLib.apiServer+"/v1/resources/"+e+"/subnodes",t=new XMLHttpRequest;t.open("POST",r,!1),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(o);let s=JSON.parse(t.responseText);console.log("数据已发送至服务器。"+t.status+" // "+JSON.stringify(s))},BackgroundLib.checkPreSendCompleteness=function(e){return void 0!==e.uuid&&void 0!==e.accessCode&&void 0!==e.url&&void 0!==e.referrer},BackgroundLib.checkVersion=function(){let e="client_version="+encodeURIComponent(BackgroundLib.manifest.version),n=BackgroundLib.apiServer+"/v1/extension/check-version?"+e,o=new XMLHttpRequest;return o.open("GET",n,!1),o.send(null),JSON.parse(o.responseText)},BackgroundLib.checkData=function(e){let n=BackgroundLib.apiServer+"/v1/item/check-data",o="uuids="+encodeURIComponent(e.toString())+"&client_version="+encodeURIComponent(BackgroundLib.manifest.version),r=new XMLHttpRequest;return r.open("POST",n,!1),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(o),JSON.parse(r.responseText)},BackgroundLib.handleResult=function(e,n,o){new Promise(function(e,n){chrome.storage.local.get({allowShare:!0},function(n){e(n.allowShare)})}).then(function(r){BackgroundLib.checkPreSendCompleteness(n[e])?(r?(BackgroundLib.sendAccessCode(n[e].uuid,n[e].accessCode),o({message:"已将提取码发送至服务器。"})):o({message:"暂时停止将提取码发送至服务器。"}),delete n[e]):o({message:"数据还不完整。",result:n})})},BackgroundLib.handleCollector=function(e,n,o){void 0!==n[e].state&&(BackgroundLib.sendState(n[e].uuid,n[e].state),o({message:"已将 State 发送至服务器。"})),void 0!==n[e].referrer&&(BackgroundLib.sendReferrer(n[e].uuid,n[e].referrer),o({message:"已将 Referrer 发送至服务器。"})),delete n[e]},BackgroundLib.handleResource=function(e,n,o){new Promise(function(e,n){chrome.storage.local.get({allowShare:!0},function(n){e(n.allowShare)})}).then(function(r){r?(BackgroundLib.sendResource(e,n),o({message:"已将 Resource 发送至服务器。"})):o({message:"暂时停止将 Resource 发送至服务器。"})})},BackgroundLib.handleSubnodes=function(e,n,o){new Promise(function(e,n){chrome.storage.local.get({allowShare:!0},function(n){e(n.allowShare)})}).then(function(r){r?(BackgroundLib.sendSubnodes(e,n),o({message:"已将 Subnodes 发送至服务器。"})):o({message:"暂时停止将 Subnodes 发送至服务器。"})})},chrome.storage.local.get({allowShare:!0},function(e){e.allowShare?chrome.browserAction.setIcon({path:{19:"images/icon_19.png",38:"images/icon_38.png"}}):chrome.browserAction.setIcon({path:{19:"images/icon-inactive_19.png",38:"images/icon-inactive_38.png"}})}),function(){let e=BackgroundLib.fetchSelector();chrome.storage.local.set({selector:e},function(){})}(),function(){let e=BackgroundLib.checkVersion();e.is_latest||(chrome.browserAction.setBadgeText({text:"new"}),chrome.browserAction.setBadgeBackgroundColor({color:[255,0,0,255]})),chrome.storage.local.set({update:e},function(){})}(),window._gaq=window._gaq||[],_gaq.push(["_setAccount","UA-109184535-1"]),_gaq.push(["_trackEvent","EXTENSION","LOADED",navigator.userAgent]),function(){let e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://ssl.google-analytics.com/ga.js";let n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}();let r={},t={};chrome.runtime.onMessage.addListener(function(e,n,o){let s=e.uuid;switch(void 0!==s&&void 0===r[s]&&(r[s]={}),void 0!==s&&void 0===t[s]&&(t[s]={}),e.cmd){case"SEND_URL":r[s].uuid=e.uuid,r[s].url=e.url,r[s].referrer=e.referrer,BackgroundLib.handleResult(s,r,o);break;case"SEND_ACCESS_CODE":r[s].uuid=e.uuid,r[s].accessCode=e.accessCode,BackgroundLib.handleResult(s,r,o);break;case"SEND_STATE":t[s].uuid=e.uuid,t[s].state=e.state,BackgroundLib.handleCollector(s,t,o);break;case"SEND_REFERRER":t[s].uuid=e.uuid,t[s].referrer=e.referrer,BackgroundLib.handleCollector(s,t,o);break;case"SEND_RESOURCE":BackgroundLib.handleResource(s,e.resource,o);break;case"SEND_RESOURCE_SUBNODES":BackgroundLib.handleSubnodes(s,e.subnodes,o);break;case"FETCH_ACCESS_CODE":let n=BackgroundLib.fetchAccessCode(e.uuid);o(n),null===n?window._gaq.push(["_trackEvent","ACCESS_CODE","FETCH_FAILED",BackgroundLib.manifest.version]):window._gaq.push(["_trackEvent","ACCESS_CODE","FETCH_SUCCEED",BackgroundLib.manifest.version]);break;case"CHECK_DATA":let i=[];for(let n in e.uncheckedUuids)e.uncheckedUuids.hasOwnProperty(n)&&i.push(n);o(BackgroundLib.checkData(i)),window._gaq.push(["_trackEvent","STATE","CHECK_DATA",BackgroundLib.manifest.version])}return!0}),chrome.webRequest.onBeforeSendHeaders.addListener(function(e){let n=BaseLib.fetchUuid(e.url);void 0!==n&&void 0===t[n]&&(t[n]={});for(let o=0;o<e.requestHeaders.length;o++)if("Referer"===e.requestHeaders[o].name){let r={url:e.requestHeaders[o].value};if(BaseLib.isInitUrl(r.url)||BaseLib.isAccessUrl(r.url))continue;t[n].uuid=n,t[n].referrer=r,function(e,n){chrome.tabs.query({url:n.url},function(n){n.length>0&&(t[e].referrer.title=n[0].title,BackgroundLib.handleCollector(e,t,function(e){console.log("收到："+JSON.stringify(e))}))})}(n,r)}return{requestHeaders:e.requestHeaders}},{urls:["https://pan.baidu.com/s/*"]},["blocking","requestHeaders"]),chrome.webRequest.onHeadersReceived.addListener(function(e){let n=BaseLib.fetchUuid(e.url);void 0!==n&&void 0===t[n]&&(t[n]={});for(let o=0;o<e.responseHeaders.length;o++)"Location"===e.responseHeaders[o].name&&"/error/404.html"===e.responseHeaders[o].value&&(t[n].uuid=n,t[n].state="INVALID",BackgroundLib.handleCollector(n,t,function(e){console.log("收到："+JSON.stringify(e))}));return{responseHeaders:e.responseHeaders}},{urls:["https://pan.baidu.com/s/*"]},["blocking","responseHeaders"])}});